(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{334:function(e,t,a){__NEXT_REGISTER_PAGE("/canvas-prototype-wip",function(){return e.exports=a(335),{page:e.exports.default}})},335:function(e,t,a){"use strict";a.r(t),a.d(t,"Index",function(){return w});var n=a(35),o=a.n(n),s=a(0),i=a.n(s),r=a(153),c=a(32),l=a.n(c),u=a(154);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var h=50,y=50,v=function(e,t){var a=e.canvas.getBoundingClientRect(),n=Math.floor((t.clientX-a.left)/10),o=Math.floor((t.clientY-a.top)/10);return n=Math.min(h-1,n),o=Math.min(y-1,o),{x:n=Math.max(0,n),y:o=Math.max(0,o)}},b=function(e,t){for(var a=e.getImageData(0,0,h,y),n=a.data,o=0;o<n.length;o+=4)n[o]=n[o]*t,n[o+1]=n[o+1]*t,n[o+2]=n[o+2]*t;e.putImageData(a,0,0)},w=function(e){function t(e){var a,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=x(t).call(this,e),a=!o||"object"!==m(o)&&"function"!=typeof o?p(n):o,f(p(p(a)),"canvasReady",function(e){console.log(e),a.ctx=e,a.imageData=e.getImageData(0,0,h,y)}),f(p(p(a)),"onEsc",function(e){27===e.keyCode&&a.clearSelection()}),f(p(p(a)),"clearSelection",function(){a.ctx.putImageData(a.imageData,0,0),a.setState({selection:{}})}),f(p(p(a)),"mouseMove",function(e,t,n){if(a.state.dragging){var o=v(e,t),s=a.state.selection.x1,i=a.state.selection.y1,r=o.x,c=o.y;s>r&&(s=r,r=a.state.selection.x1),i>c&&(i=c,c=a.state.selection.y1),a.setState({selection:{x1:a.state.selection.x1,y1:a.state.selection.y1,x2:o.x,y2:o.y}});var l=r-s,u=c-i;if(l>=0&&u>=0){var m=a.selectionContext.getImageData(s,i,l+1,u+1),d=a.refs.selectionCanvas.getContext("2d");d.clearRect(0,0,100,100),e.putImageData(a.imageData,0,0),b(e,.5),e.putImageData(m,s,i),d.putImageData(m,0,0)}}else{var x=v(e,t);a.setState({currentMousePosition:x}),a.state.hovering||(b(e,.5),a.setState({hovering:!0}))}}),f(p(p(a)),"mouseOut",function(e,t){a.state.dragging&&a.mouseUp(e,t),a.setState({currentMousePosition:{x:0,y:0}}),a.state.hovering&&(e.putImageData(a.imageData,0,0),a.setState({hovering:!1}))}),f(p(p(a)),"mouseDown",function(e,t){e.putImageData(a.imageData,0,0),a.selectionCanvas=document.createElement("canvas"),a.selectionCanvas.width=h,a.selectionCanvas.height=y,a.selectionContext=a.selectionCanvas.getContext("2d"),a.selectionContext.putImageData(a.imageData,0,0),a.dragStartSound.play();var n=v(e,t);a.setState({dragging:!0,selection:{x1:n.x,y1:n.y,x2:n.x,y2:n.y}}),b(e,.5),a.mouseMove(e,t)}),f(p(p(a)),"mouseUp",function(e,t){if(a.state.dragging){var n=v(e,t);a.setState({dragging:!1,selection:Object.assign({},a.state.selection,{x2:n.x,y2:n.y})});var o=n.x-a.state.selection.x1,s=n.y-a.state.selection.y1,i=a.refs.selectionCanvas.getContext("2d");if(i.clearRect(0,0,100,100),0!==o&&0!==s){var r=e.getImageData(a.state.selection.x1,a.state.selection.y1,o,s);i.putImageData(r,0,0),a.dragStopSound.play()}else a.dragStopSound.play()}}),f(p(p(a)),"selectedPixels",function(){var e=[],t=a.state.selection.x1,n=a.state.selection.y1,o=a.state.selection.x2,s=a.state.selection.y2;t>o&&(t=o,o=a.state.selection.x1),n>s&&(n=s,s=a.state.selection.y1);for(var i=n;i<=s;i++)for(var r=t;r<=o;r++)e.push(i*h+r);return e}),f(p(p(a)),"rowRenderer",function(e){var t=e.key,n=e.index,o=(e.isScrolling,e.isVisible,e.style);return i.a.createElement("div",{key:t,style:o},"Pixel #",a.selectedPixels()[n])}),"undefined"!=typeof window&&(a.dragStartSound=new l.a.Sound("/static/dragstart.mp3"),a.draggingSound=new l.a.Sound("/static/dragging.mp3"),a.dragStopSound=new l.a.Sound("/static/dragend.mp3"),a.dragFailSound=new l.a.Sound("/static/dragfail.mp3")),a.state={dragging:!1,selection:{},currentMousePosition:{x:0,y:0}},a}var a,n,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,s["Component"]),a=t,(n=[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onEsc,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onEsc,!1)}},{key:"render",value:function(){return i.a.createElement("div",{className:"main"},i.a.createElement("div",{className:"jsx-4179034185 header"},i.a.createElement("h1",{className:"jsx-4179034185"},"everi",i.a.createElement("span",{className:"jsx-4179034185"},"Pixel")),i.a.createElement(o.a,{styleId:"4179034185",css:["h1.jsx-4179034185{color:#858585;font-size:24px;margin:0;}","h1.jsx-4179034185 span.jsx-4179034185{color:#fff;}",".header.jsx-4179034185{border-bottom:1px solid #222222;padding:20px;margin-bottom:20px;}"]})),i.a.createElement(r.a,{width:h,height:y,onReady:this.canvasReady,onMouseOut:this.mouseOut,onMouseMove:this.mouseMove,onMouseDown:this.mouseDown,onMouseUp:this.mouseUp,scale:10}),i.a.createElement("div",{className:"jsx-1921656205 controls"},i.a.createElement("div",{className:"jsx-1921656205 selection"},i.a.createElement("div",{className:"jsx-1921656205 selectionPreview"},i.a.createElement("canvas",{width:"100px",height:"100px",ref:"selectionCanvas",className:"jsx-1921656205"})),i.a.createElement("h2",{className:"jsx-1921656205"},void 0!==this.state.selection.x1?i.a.createElement("div",{className:"jsx-1921656205"},"SelectionÂ ",i.a.createElement("span",{onClick:this.clearSelection,className:"jsx-1921656205"},"[ESC]")):"No selection"),void 0!==this.state.selection.x1?this.state.selection.x1===this.state.selection.x2&&this.state.selection.y1==this.state.selection.y2?i.a.createElement("div",{className:"jsx-1921656205"},"(",this.state.selection.x1,",",this.state.selection.y1,")"):i.a.createElement("div",{className:"jsx-1921656205"},"(",this.state.selection.x1,",",this.state.selection.y1,") to (",this.state.selection.x2,",",this.state.selection.y2,")"):i.a.createElement("div",{className:"jsx-1921656205"},"(",this.state.currentMousePosition.x,",",this.state.currentMousePosition.y,")")),i.a.createElement("hr",{className:"jsx-1921656205"}),i.a.createElement("div",{className:"jsx-1921656205 pixelList"},this.state.dragging?"":i.a.createElement(u.a,{width:300,height:300,rowCount:this.selectedPixels().length,rowHeight:20,rowRenderer:this.rowRenderer})),i.a.createElement(o.a,{styleId:"1921656205",css:[".controls.jsx-1921656205{float:left;color:#fff;font-size:16px;width:320px;}",".pixelList.jsx-1921656205{height:600px;overflow-y:scroll;}",".pixelList.jsx-1921656205::-webkit-scrollbar{width:10px;}",".pixelList.jsx-1921656205::-webkit-scrollbar *.jsx-1921656205{background:#222;}",".pixelList.jsx-1921656205::-webkit-scrollbar-thumb{background:rgba(50,50,50,1) !important;}",".selectionPreview.jsx-1921656205{width:100px;height:100px;border:1px solid #222222;float:left;margin-right:20px;margin-bottom:10px;}","h2.jsx-1921656205{color:#858585;font-size:16px;margin:0;margin-bottom:10px;}","hr.jsx-1921656205{clear:both;border-color:#222;}"]})))}}])&&d(a.prototype,n),c&&d(a,c),t}();t.default=w}},[[334,1,0]]]);